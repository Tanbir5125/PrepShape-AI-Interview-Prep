{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/tannu/Desktop/Project/interview_prep/lib/actions/auth.action.ts"],"sourcesContent":["\"use server\";\n\nimport { auth, db } from \"@/firebase/admin\";\nimport { cookies } from \"next/headers\";\n\nconst ONE_WEEK = 60 * 60 * 24 * 7; // 7 days\n\nexport async function signUp(params: SignUpParams) {\n  const { uid, name, email } = params;\n\n  try {\n    const userRecord = await db.collection(\"users\").doc(uid).get();\n\n    if (userRecord.exists) {\n      return {\n        success: false,\n        message: \"User already exists. Please sign in.\",\n      };\n    }\n    await db.collection(\"users\").doc(uid).set({\n      name,\n      email,\n    });\n\n    return {\n      success: true,\n      message: \"Account created successfully\",\n    };\n  } catch (error: any) {\n    console.error(\"Error during sign up:\", error);\n\n    if (error.code === \"auth/email-already-exists\") {\n      return {\n        success: false,\n        message: \"This email is already in use.\",\n      };\n    }\n    return {\n      success: false,\n      message: \"Failed to create an account\",\n    };\n  }\n}\n\nexport async function signIn(params: SignInParams) {\n  const { email, idToken } = params;\n\n  try {\n    const userRecord = await auth.getUserByEmail(email);\n\n    if (!userRecord) {\n      return {\n        success: false,\n        message: \"User not found. Please sign up.\",\n      };\n    }\n\n    await setSessionCookie(idToken);\n  } catch (error) {\n    console.error(error);\n    return {\n      success: false,\n      message: \"Failed to sign in\",\n    };\n  }\n}\n\nexport async function signOut() {\n  const cookieStore = await cookies();\n\n  cookieStore.delete(\"session\");\n}\n\nexport async function setSessionCookie(idToken: string) {\n  const cookieStore = await cookies();\n\n  const sessionCookie = await auth.createSessionCookie(idToken, {\n    expiresIn: ONE_WEEK * 1000, // Convert to milliseconds\n  });\n\n  cookieStore.set(\"session\", sessionCookie, {\n    maxAge: ONE_WEEK,\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    path: \"/\",\n    sameSite: \"lax\",\n  });\n}\n\nexport async function getCurrentUser(): Promise<User | null> {\n  const cookieStore = await cookies();\n\n  const sessionCookie = cookieStore.get(\"session\")?.value;\n  if (!sessionCookie) return null;\n\n  try {\n    const decodedClaims = await auth.verifySessionCookie(sessionCookie, true);\n\n    // get user info from db\n    const userRecord = await db\n      .collection(\"users\")\n      .doc(decodedClaims.uid)\n      .get();\n    if (!userRecord.exists) return null;\n\n    return {\n      ...userRecord.data(),\n      id: userRecord.id,\n    } as User;\n  } catch (error) {\n    console.log(error);\n\n    // Invalid or expired session\n    return null;\n  }\n}\n\nexport async function isAuthenticated() {\n  const user = await getCurrentUser();\n\n  return !!user;\n}"],"names":[],"mappings":";;;;;;IAmEsB,UAAA,WAAA,GAAA,CAAA,GAAA,yNAAA,CAAA,wBAAA,EAAA,8CAAA,yNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,yNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///Users/tannu/Desktop/Project/interview_prep/components/SignOutButton.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { signOut } from \"@/lib/actions/auth.action\";\n\nconst SignOutButton = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const router = useRouter();\n\n  const handleSignOut = async () => {\n    try {\n      setIsLoading(true);\n      await signOut();\n      router.push(\"/sign-in\");\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <button\n      onClick={handleSignOut}\n      disabled={isLoading}\n      className=\"btn-primary text-white py-2 px-4 rounded-md transition-colors duration-300 flex items-center gap-2\"\n    >\n      {isLoading ? (\n        <span className=\"inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em]\"></span>\n      ) : (\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n        >\n          <path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\"></path>\n          <polyline points=\"16 17 21 12 16 7\"></polyline>\n          <line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\"></line>\n        </svg>\n      )}\n      {isLoading ? \"Signing out...\" : \"Sign out\"}\n    </button>\n  );\n};\n\nexport default SignOutButton;\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;AAJA;;;;AAMA,MAAM,gBAAgB;;IACpB,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,gBAAgB;QACpB,IAAI;YACF,aAAa;YACb,MAAM,CAAA,GAAA,yJAAA,CAAA,UAAO,AAAD;YACZ,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;QACtC,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,6LAAC;QACC,SAAS;QACT,UAAU;QACV,WAAU;;YAET,0BACC,6LAAC;gBAAK,WAAU;;;;;qCAEhB,6LAAC;gBACC,OAAM;gBACN,OAAM;gBACN,QAAO;gBACP,SAAQ;gBACR,MAAK;gBACL,QAAO;gBACP,aAAY;gBACZ,eAAc;gBACd,gBAAe;;kCAEf,6LAAC;wBAAK,GAAE;;;;;;kCACR,6LAAC;wBAAS,QAAO;;;;;;kCACjB,6LAAC;wBAAK,IAAG;wBAAK,IAAG;wBAAK,IAAG;wBAAI,IAAG;;;;;;;;;;;;YAGnC,YAAY,mBAAmB;;;;;;;AAGtC;GA5CM;;QAEW,qIAAA,CAAA,YAAS;;;KAFpB;uCA8CS","debugId":null}}]
}